"use strict";(self.webpackChunknancy_docs=self.webpackChunknancy_docs||[]).push([[7627],{2440:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"tutorials/first-tutorial/Examples/iwrr-tandem","title":"Study of an IWRR tandem","description":"The examples shown in this page can be found, in notebook form, on GitHub.","source":"@site/docs/tutorials/first-tutorial/Examples/iwrr-tandem.mdx","sourceDirName":"tutorials/first-tutorial/Examples","slug":"/tutorials/first-tutorial/Examples/iwrr-tandem","permalink":"/nancy/docs/tutorials/first-tutorial/Examples/iwrr-tandem","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"hide_title":true,"sidebar_position":2,"title":"Study of an IWRR tandem"},"sidebar":"tutorialSidebar","previous":{"title":"Simple computations","permalink":"/nancy/docs/tutorials/first-tutorial/Examples/simple-computations"},"next":{"title":"Overview","permalink":"/nancy/docs/tutorials/optimizations/overview"}}');var r=t(4848),a=t(8453),s=t(6025);const o={hide_title:!0,sidebar_position:2,title:"Study of an IWRR tandem"},c="Study of an IWRR tandem",l={},d=[];function u(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",header:"header",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"study-of-an-iwrr-tandem",children:"Study of an IWRR tandem"})}),"\n",(0,r.jsx)(n.admonition,{type:"info",children:(0,r.jsxs)(n.p,{children:["The examples shown in this page can be found, in ",(0,r.jsx)(n.a,{href:"/docs/tutorials/getting-started/notebooks",children:"notebook"})," form, on ",(0,r.jsx)(n.a,{href:"https://github.com/rzippo/nancy/blob/master/examples/iwrr-tandem-study-example.dib",children:"GitHub"}),"."]})}),"\n",(0,r.jsx)(n.p,{children:"Using the IWRR model in the previous page, we can exemplify a study where non-convex service curves arise, hence a case where the flexibility of Nancy is useful."}),"\n",(0,r.jsx)(n.p,{children:"Consider a flow traversing a tandem network of 2 server nodes.\nAccess to each node is independently regulated using IWRR scheduling (with a different set of cross flows)."}),"\n",(0,r.jsxs)(n.p,{children:["We consider the flow to be shaped by a token-bucket arrival curve.\nAt each node, the flow is given an allocation matching said rate.\nFor the DNC analysis, we use again the IWRR model described in ",(0,r.jsx)("a",{href:"/docs/tutorials/references#TLBB21",children:"[TLBB21]"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["First we (trivially) generalize the IWRR service curve computation as ",(0,r.jsx)(n.code,{children:"IwrrServiceCurve()"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"Curve IwrrServiceCurve(int foi, int[] weights, int[] l_min, int[] l_max, SuperAdditiveCurve beta)\n{\n    var unit_rate = new RateLatencyServiceCurve(1, 0);\n\n    // parameters computation omitted for brevity\n    int Phi_i_j(int i, int j, int x) { ... }\n    int Psi_i(int i, int x) { ... }\n    int L_tot(int i) { ... }\n    \n    var stairs = new List<Curve>();\n    for(int k = 0; k < weights[foi]; k++)\n    {\n        var stair = new StairCurve(l_min[foi], L_tot(foi));\n        var delayed_stair = stair.DelayBy(Psi_i(foi, k * l_min[foi])); \n        stairs.Add( delayed_stair );\n    }\n    var U_i = Curve.Addition(stairs); // summation of min-plus curves\n    var gamma_i = Curve.Convolution(unit_rate, U_i);\n    var beta_i = Curve.Composition(gamma_i, beta);\n    return beta_i;\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:"Then, we define the parameters of our network"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"// ms as time unit, bit as data unit\n// the flow has a max arrival rate of 10 Mbps, and is guaranteed such bandwidth at each node\nvar foi_ac = new SigmaRhoArrivalCurve(1024, 10000);\n\n// 100 Mb/s, 1 ms of latency\n// 3 cross flows\nvar b1 = new RateLatencyServiceCurve(100000, 1);\nvar weights_1 = new []{10, 30, 40, 20};\nvar l_min_1 = new []{512, 512, 512, 512};\nvar l_max_1 = new []{1024, 1024, 1024, 1024};\n\n// 200 Mb/s, 1 ms of latency\n// 5 cross flows\nvar b2 = new RateLatencyServiceCurve(200000, 1);\nvar weights_2 = new []{10, 20, 40, 50, 30, 50};\nvar l_min_2 = new []{512, 512, 512, 512, 512, 512};\nvar l_max_2 = new []{1024, 1024, 1024, 1024, 1024, 1024};\n"})}),"\n",(0,r.jsx)(n.p,{children:"We can now compute the IWRR service curve at each node."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"var b_eq_1 = IwrrServiceCurve(0, weights_1, l_min_1, l_max_1, b1);\nvar b_eq_2 = IwrrServiceCurve(0, weights_2, l_min_2, l_max_2, b2);\n"})}),"\n",(0,r.jsxs)("figure",{children:[(0,r.jsx)("img",{src:(0,s.Ay)("/img/tutorials/b_eq_i.png"),alt:"Plot of the IWRR service curves at the two nodes."}),(0,r.jsx)("figcaption",{children:"Figure 1: Plot of the IWRR service curves at the two nodes."})]}),"\n",(0,r.jsxs)(n.p,{children:["Note that the above are non-convex, and their period lengths are not integers.\nWe complete the study by computing the equivalent service curve for the tandem using the min-plus convolution, and then computing the worst-case delay and backlog bounds as, respectively, the horizontal and the vertical deviation between the ",(0,r.jsx)(n.em,{children:"foi"})," arrival curve and said service curve."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"var b_eq = Curve.Convolution(b_eq_1, b_eq_2);\nvar delay_bound = Curve.HorizontalDeviation(foi_ac, b_eq);\n// Output: 3,46 ms\nvar backlog_bound = Curve.VerticalDeviation(foi_ac, b_eq);\n// Output: 34900 bit\n"})}),"\n",(0,r.jsxs)("figure",{children:[(0,r.jsx)("img",{src:(0,s.Ay)("/img/tutorials/b_eq vs foi_ac.png"),alt:"Plot of the equivalent service curve and the foi arrival curve."}),(0,r.jsxs)("figcaption",{children:["Figure 2: Plot of the equivalent service curve and the ",(0,r.jsx)("em",{children:"foi"})," arrival curve."]})]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>o});var i=t(6540);const r={},a=i.createContext(r);function s(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);